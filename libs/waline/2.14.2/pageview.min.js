!function(e,t){"function"==typeof define&&define.amd?define("Waline",["exports"],t):"undefined"!=typeof exports?t(exports):(t(t={}),e.Waline=t)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.version=e.pageviewCount=void 0;const s={"Content-Type":"application/json"},c=e=>{e=function(e){let t=0<arguments.length&&void 0!==e?e:"";return t.replace(/\/$/u,"")}(e);return/^(https?:)?\/\//.test(e)?e:"https://"+e},g=e=>{"AbortError"!==e.name&&console.error(e.message)},f=e=>e.dataset.path||e.getAttribute("id"),d=(n,e)=>{e.forEach((e,t)=>{e.innerText=n[t].toString()})};e.pageviewCount=t=>{let{serverURL:e,path:n=window.location.pathname,selector:r=".waline-pageview-count",update:a=!0,lang:p="zh-CN"}=t;const h=new AbortController,o=Array.from(document.querySelectorAll(r)),i=e=>{e=f(e);return null!==e&&n!==e},l=t=>(()=>{var{serverURL:o,lang:i,paths:l,signal:s}={serverURL:c(e),paths:t.map(e=>f(e)||n),lang:p,signal:h.signal};return(()=>{let{serverURL:e,lang:t,paths:n,type:r,signal:a}={serverURL:o,lang:i,paths:l,type:["time"],signal:s};return fetch(`${e}/article?path=${encodeURIComponent(n.join(","))}&type=${encodeURIComponent(r.join(","))}&lang=`+t,{signal:a}).then(e=>e.json())})().then(e=>Array.isArray(e)?e:[e])})().then(e=>d(e,t)).catch(g);if(a){const t=o.filter(e=>!i(e)),g=o.filter(i);(e=>{var{serverURL:e,lang:t,path:n,type:r,action:a}={...e,type:"time",action:"inc"};return fetch(e+"/article?lang="+t,{method:"POST",headers:s,body:JSON.stringify({path:n,type:r,action:a})}).then(e=>e.json())})({serverURL:c(e),path:n,lang:p}).then(e=>d(new Array(t.length).fill(e),t)),g.length&&l(g)}else l(o);return h.abort.bind(h)},e.version="2.14.2"});